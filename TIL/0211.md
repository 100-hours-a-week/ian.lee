이미지 빌드





D2hub : 도커의 빌드 기능을 활용해 컨테이너 이미지를 생성하는 역할



D2Hub 이미지 빌드를 위해 도커파일 필요함 → 깃허브 루트 디렉토리에 도커파일이 위치해야 함



깃허브 연동 후 D2hub 레포지토리 생성 후 이미지 빌드 실행



빌드 : 소스코드를 모아 실행 가능한 이미지를 만드는 것



이러면 도커파일 및 소스코드로 이미지를 생성함(즉 실행파일을 생성함)





Kargo 배포 - 구성파일 작성





Kargo : 쿠버네티스와 연동하여 이미지를 배포하고 관리하는 역할



루트 디렉토리의 k8s(쿠버네티스) 폴더 하위에 있는 쿠버네티스 리소스 구성파일 작성 ⇒ kustomization.yaml 파일을 작성



yaml에서는 k8s 폴더에 함께 있는 구성 파일들을 참조하도록 작성함



🔥파일 작성 시 D2Hub 이미지 경로를 사용해서 작성 (빌드한 이미지 경로 복사해서 넣어야 함)🔥



이후 배포 앱에 연결된 외부 접속 URL 발급을 위해 Ingress 객체 작성



깃허브 main에 push





Kargo 배포 - App 생성





다 완료되었으면 Kargo에서 배포 버튼 클릭하여 앱 생성함





Kargo 배포 - k8s파일 유효성 확인





오류가 없는지 확인





Kargo 배포 - DKOS 클러스터 배포





yaml에 명시된 이미지 주소를 타고 가서 D2Hub에 있는 이미지를 가져와 DKOS 클러스터에 배포함





외부 URL 등록





배포한 앱과 연결할 외부 URL 발급해야 함



구성파일 작성 시 작성한 Ingress 객체의 IP를 특정 URL과 연결



IP가 자동으로 불려오고, 외부 접속 URL이 발급됨 (발급 버튼)



이제 해당 URL로 app 접속 가능함

